<?xml version="1.0" encoding="iso-8859-1"?>
<sspaceex xmlns="http://www-verimag.imag.fr/xml-namespaces/sspaceex" version="0.2" math="SpaceEx">
  <component id="train">
    <param name="i" type="real" local="true" d1="1" d2="1" dynamics="any" />
    <param name="j" type="real" local="true" d1="1" d2="1" dynamics="any" />
    <param name="pos" type="real" local="false" d1="1" d2="1" dynamics="any" placement="west" />
    <param name="v" type="real" local="true" d1="1" d2="1" dynamics="any" />
    <param name="dir" type="real" local="false" d1="1" d2="1" dynamics="any" controlled="true" placement="east" />
    <param name="time" type="real" local="true" d1="1" d2="1" dynamics="any" />
    <param name="urstopped" type="real" local="true" d1="1" d2="1" dynamics="any" />
    <param name="Delay" type="real" local="true" d1="1" d2="1" dynamics="any" controlled="false" />
    <param name="S" type="real" local="true" d1="1" d2="1" dynamics="any" controlled="false" />
    <param name="acc" type="real" local="true" d1="1" d2="1" dynamics="any" />
    <location id="1" name="init" x="886.0" y="227.0">
      <invariant>time&lt;=Delay</invariant>
      <flow>time'==1</flow>
    </location>
    <location id="2" name="stop" x="886.0" y="381.0" width="110.0" height="64.0">
      <invariant>v==0,pos==S</invariant>
      <flow>pos'==v &amp; v'==0</flow>
    </location>
    <location id="3" name="ChangeDirection" x="887.0" y="516.0" width="146.0" height="66.0">
      <invariant>time&lt;=30</invariant>
      <flow>time'==1</flow>
    </location>
    <location id="4" name="run" x="622.0" y="517.0" width="180.0" height="74.0">
      <invariant>abs(pos-S)&gt;=500 &amp; v&lt;=20</invariant>
      <flow>pos'==dir*v &amp; v'==0.5</flow>
    </location>
    <location id="5" name="stablerun" x="387.0" y="485.0" width="144.0" height="68.0">
      <invariant>abs(pos-S)&gt;=500</invariant>
      <flow>pos'==dir*v &amp; v'==0</flow>
    </location>
    <location id="6" name="near" x="574.0" y="311.0" width="178.0" height="72.0">
      <invariant>abs(pos-S)&gt;=0</invariant>
      <flow>pos'==dir*v &amp; v'==acc</flow>
    </location>
    <location id="7" name="urgent_dec" x="223.0" y="313.0" width="152.0" height="64.0">
      <invariant>v&gt;=0</invariant>
      <flow>pos'==dir*v &amp; v'==-1.5</flow>
    </location>
    <location id="8" name="urgent_stop" x="222.0" y="136.0" width="142.0" height="62.0">
      <invariant>v==0</invariant>
      <flow>pos'==v &amp; v'==0</flow>
    </location>
    <location id="9" name="urgent_inc" x="539.0" y="136.0" width="156.0" height="70.0">
      <invariant>v&lt;=maxv</invariant>
      <flow>pos'==dir*v &amp; v'==0.5</flow>
    </location>
    <location id="10" name="recover" x="765.0" y="136.0" width="166.0" height="62.0">
      <invariant>v&gt;=0</invariant>
      <flow>pos'==dir*v &amp; v'==-0.5</flow>
    </location>
    <transition source="1" target="2">
      <guard>time==Delay</guard>
      <assignment>j=0,stop=1</assignment>
      <labelposition x="23.0" y="-38.0" width="122.0" height="84.0" />
    </transition>
    <transition source="3" target="2" bezier="true">
      <guard>time==30</guard>
      <assignment>dir=-dir,stop=1</assignment>
      <labelposition x="-4.0" y="-6.0" width="122.0" height="76.0" />
      <middlepoint x="978.0" y="405.0" />
      <waypoints>
        <beforemiddle>972.0,492.0</beforemiddle>
      </waypoints>
    </transition>
    <transition source="2" target="3">
      <guard>(j==N-1 &amp; dir ==1) | 
(j==0 &amp; dir ==-1)</guard>
      <assignment>time=0,start=1,stop=0</assignment>
      <labelposition x="-140.0" y="-40.0" width="156.0" height="72.0" />
    </transition>
    <transition source="2" target="4">
      <guard>(dir==1 &amp; j&lt;N-1) | (dir==-1 &amp; j&gt;0)</guard>
      <assignment>j=j+dir,start=1</assignment>
      <labelposition x="-26.0" y="-76.0" width="222.0" height="54.0" />
      <middlepoint x="621.0" y="438.0" />
    </transition>
    <transition source="4" target="5">
      <guard>v==20</guard>
      <labelposition x="-19.0" y="-47.0" />
      <middlepoint x="497.5" y="514.0" />
    </transition>
    <transition source="6" target="2">
      <guard>abs(pos-S)&lt;=1</guard>
      <assignment>v=0,pos=S,stop=1</assignment>
      <labelposition x="-91.0" y="-56.0" width="114.0" height="60.0" />
      <middlepoint x="763.0" y="312.0" />
    </transition>
    <transition source="4" target="6">
      <guard>abs(pos-S)&lt;=500</guard>
      <assignment>acc=-v*v*0.001</assignment>
      <labelposition x="-108.0" y="-53.0" width="114.0" height="70.0" />
      <middlepoint x="578.0" y="416.0" />
    </transition>
    <transition source="5" target="6">
      <guard>abs(pos-S)&lt;=500</guard>
      <assignment>acc=-v*v*0.001</assignment>
      <labelposition x="-111.0" y="-2.0" width="118.0" height="68.0" />
      <middlepoint x="411.5" y="383.0" />
      <waypoints>
        <beforemiddle>412.0,448.0</beforemiddle>
        <aftermiddle>429.0,368.0</aftermiddle>
      </waypoints>
    </transition>
    <transition source="5" target="7">
      <guard>urstop==1</guard>
      <labelposition x="-9.0" y="-130.0" width="106.0" height="50.0" />
      <middlepoint x="277.0" y="484.0" />
    </transition>
    <transition source="4" target="7">
      <guard>urstop==1</guard>
      <labelposition x="-4.0" y="-42.0" width="98.0" height="54.0" />
      <middlepoint x="219.5" y="551.0" />
      <waypoints>
        <beforemiddle>461.0,555.0</beforemiddle>
        <aftermiddle>219.0,397.0</aftermiddle>
      </waypoints>
    </transition>
    <transition source="6" target="7">
      <guard>urstop==1</guard>
      <labelposition x="-39.0" y="-55.0" width="114.0" height="50.0" />
    </transition>
    <transition source="7" target="8">
      <guard>v&lt;=0.1</guard>
      <assignment>urstopped=1</assignment>
      <labelposition x="4.0" y="-36.0" width="108.0" height="62.0" />
    </transition>
    <transition source="8" target="9">
      <guard>urstart==1</guard>
      <assignment>maxv=sqrt(0.5*abs(pos-S))</assignment>
      <labelposition x="-86.0" y="-61.0" width="178.0" height="64.0" />
    </transition>
    <transition source="9" target="10">
      <guard>v&gt;=maxv</guard>
      <labelposition x="-38.0" y="-48.0" width="78.0" height="50.0" />
    </transition>
    <transition source="10" target="2">
      <guard>abs(pos-S)&lt;=1</guard>
      <assignment>stop=1,v=0,pos=S</assignment>
      <labelposition x="-137.0" y="-35.0" width="184.0" height="72.0" />
      <middlepoint x="765.5" y="212.5" />
    </transition>
    <transition source="10" target="7">
      <guard>urstop==1</guard>
      <labelposition x="97.0" y="-48.0" width="88.0" height="50.0" />
      <middlepoint x="400.0" y="239.5" />
      <waypoints>
        <beforemiddle>587.0,237.0</beforemiddle>
      </waypoints>
    </transition>
    <transition source="9" target="7">
      <guard>urstop==1</guard>
      <labelposition x="-13.0" y="-10.0" width="96.0" height="50.0" />
      <middlepoint x="376.0" y="170.5" />
      <waypoints>
        <aftermiddle>290.0,279.0</aftermiddle>
      </waypoints>
    </transition>
  </component>
  <component id="traindoors">
    <location id="1" name="loc1" x="210.0" y="110.0" />
  </component>
  <component id="screendoors">
    <location id="1" name="loc1" x="210.0" y="110.0" />
  </component>
  <component id="controller">
    <location id="1" name="loc1" x="210.0" y="110.0" />
  </component>
  <component id="urgentcontrol">
    <param name="time" type="real" local="true" d1="1" d2="1" dynamics="any" />
    <param name="pos1" type="real" local="false" d1="1" d2="1" dynamics="any" controlled="false" />
    <param name="pos2" type="real" local="false" d1="1" d2="1" dynamics="any" controlled="false" />
    <param name="pos3" type="real" local="false" d1="1" d2="1" dynamics="any" controlled="false" />
    <param name="pos4" type="real" local="false" d1="1" d2="1" dynamics="any" controlled="false" />
    <param name="dir1" type="real" local="false" d1="1" d2="1" dynamics="any" controlled="false" placement="east" />
    <param name="dir2" type="real" local="false" d1="1" d2="1" dynamics="any" controlled="false" placement="east" />
    <param name="dir3" type="real" local="false" d1="1" d2="1" dynamics="any" controlled="false" placement="east" />
    <param name="dir4" type="real" local="false" d1="1" d2="1" dynamics="any" controlled="false" placement="east" />
    <location id="1" name="init" x="385.0" y="217.0">
      <invariant>time&lt;=200</invariant>
      <flow>time'==1</flow>
    </location>
    <location id="2" name="decide" x="570.0" y="218.0">
      <invariant>time&lt;=1</invariant>
      <flow>time'==1</flow>
    </location>
    <location id="3" name="loc1" x="751.0" y="217.0" />
    <transition source="1" target="2">
      <guard>time==200</guard>
      <assignment>time=0</assignment>
      <labelposition x="-63.0" y="-47.0" width="128.0" height="86.0" />
    </transition>
    <transition source="2" target="3">
      <guard>time==1</guard>
      <assignment>train1.</assignment>
      <labelposition x="-46.0" y="-10.0" width="106.0" height="64.0" />
    </transition>
  </component>
  <component id="system">
    <param name="pos1" type="real" local="false" d1="1" d2="1" dynamics="any" controlled="true" x="335.0" y="294.0" />
    <param name="pos2" type="real" local="false" d1="1" d2="1" dynamics="any" controlled="true" x="306.0" y="161.0" />
    <param name="pos3" type="real" local="false" d1="1" d2="1" dynamics="any" controlled="true" x="280.0" y="22.0" />
    <param name="pos4" type="real" local="false" d1="1" d2="1" dynamics="any" controlled="true" x="279.0" y="391.0" />
    <param name="dir1" type="real" local="false" d1="1" d2="1" dynamics="any" controlled="true" x="548.0" y="213.0" />
    <param name="dir2" type="real" local="false" d1="1" d2="1" dynamics="any" controlled="true" x="590.0" y="84.0" />
    <param name="dir3" type="real" local="false" d1="1" d2="1" dynamics="any" controlled="true" x="633.0" y="-56.0" />
    <param name="dir4" type="real" local="false" d1="1" d2="1" dynamics="any" controlled="true" x="634.0" y="313.0" />
    <bind component="train" as="train_1" width="156.0" height="70.0" x="516.0" y="273.0">
      <map key="pos">pos1</map>
      <map key="dir">dir1</map>
    </bind>
    <bind component="urgentcontrol" as="urgentcontrol_1" width="76.0" height="130.0" x="512.0" y="418.0">
      <map key="pos1">pos1</map>
      <map key="pos2">pos2</map>
      <map key="pos3">pos3</map>
      <map key="pos4">pos4</map>
      <map key="dir1">dir1</map>
      <map key="dir2">dir2</map>
      <map key="dir3">dir3</map>
      <map key="dir4">dir4</map>
    </bind>
    <bind component="train" as="train_2" x="520.0" y="168.0" width="162.0" height="70.0">
      <map key="pos">pos2</map>
      <map key="dir">dir2</map>
    </bind>
    <bind component="train" as="train_3" x="521.0" y="70.0" width="164.0" height="76.0">
      <map key="pos">pos3</map>
      <map key="dir">dir3</map>
    </bind>
    <bind component="train" as="train_4" x="521.0" y="558.0" width="162.0" height="76.0">
      <map key="pos">pos4</map>
      <map key="dir">dir4</map>
    </bind>
  </component>
</sspaceex>

